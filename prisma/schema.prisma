model CategoryBudget {
  id       String   @id @default(uuid())
  name     String   // instead of "category"
  planned  Float
  allocated Float
  spent    Float   @default(0)

  budgetId String
  budget   Budget  @relation(fields: [budgetId], references: [id])

  expenses Expense[]

  @@index([name])
  @@map("category_budgets")
}

model Expense {
  id           String         @id @default(uuid())
  amount       Float
  date         DateTime
  description  String?
  vendor       String?

  activityType String?        // FIXED: this field didn't exist
  rejectionReason String?     // FIXED: UI expects this

  receiptUrl   String?
  status       ExpenseStatus  @default(PENDING)

  categoryId   String
  category     CategoryBudget @relation(fields: [categoryId], references: [id])

  submittedById String
  submittedBy   User          @relation("SubmittedExpenses", fields: [submittedById], references: [id])

  approvedById  String?
  approvedBy    User?         @relation("ApprovedExpenses", fields: [approvedById], references: [id])

  logs         ExpenseLog[]
  createdAt    DateTime       @default(now())

  @@index([status])
  @@index([submittedById])
  @@index([approvedById])
  @@map("expenses")
}